module mod_nrel5mw
! https://forums.nrel.gov/t/aerodyn-output-file/352
!  Element       RELM      Twist        DR       Chord      NFoil     Print?   Tip-loss   Hub-loss
!      (-)        (m)      (deg)        (m)        (m)        (-)   (Yes/No)   constant   constant
!        1    2.86670   13.30800    2.73330    3.54200          1         No   31.46474    1.36670
!        2    5.60000   13.30800    2.73330    3.85400          1         No   15.37500    4.10000
!        3    8.33330   13.30800    2.73330    4.16700          2         No    9.84005    6.83330
!        4   11.75000   13.30800    4.10000    4.55700          3         No    6.54255   10.25000
!        5   15.85000   11.48000    4.10000    4.65200          4         No    4.46215   14.35000
!        6   19.95000   10.16200    4.10000    4.45800          4         No    3.23684   18.45000
!        7   24.05000    9.01100    4.10000    4.24900          5         No    2.42931   22.55000
!        8   28.15000    7.79500    4.10000    4.00700          6         No    1.85702   26.65000
!        9   32.25000    6.54400    4.10000    3.74800          6         No    1.43023   30.75000
!       10   36.35000    5.36100    4.10000    3.50200          7         No    1.09973   34.85000
!       11   40.45000    4.18800    4.10000    3.25600          7         No    0.83622   38.95000
!       12   44.55000    3.12500    4.10000    3.01000          8         No    0.62121   43.05000
!       13   48.65000    2.31900    4.10000    2.76400          8         No    0.44245   47.15000
!       14   52.75000    1.52600    4.10000    2.51800          8         No    0.29147   51.25000
!       15   56.16670    0.86300    2.73330    2.31300          8         No    0.18249   54.66670
!       16   58.90000    0.37000    2.73330    2.08600          8         No    0.10441   57.40000
!       17   61.63330    0.10600    2.73330    1.41900          8         No    0.03326   60.13330

   real, save ::  rotorradius = 62.940  ! (m)
   real, save ::  hubradius    = 1.499   ! (m)
   integer, parameter :: nrchords=17      ! number of chords along blade

! relm is the location of the center point of the element on the blade.
! The blade starts at hubradius (1.5 m) and adding dr(1)/2=0.5*2.7333 gives the relm(1)=2.86667.
! A blade segment then runs from relm(i)-dr(i)/2 to relm(i)+dr(i)/2 where the average width is chord(i)

   real, save :: relm(nrchords)    = [ 2.86670, 5.60000, 8.33330, 11.75000, 15.85000, 19.95000, 24.05000, 28.15000, 32.25000,&
                                       36.35000, 40.45000, 44.55000, 48.65000, 52.75000, 56.16670, 58.90000, 61.63330 ]

   real, save :: dc(nrchords)      = [ 2.73330, 2.73330, 2.73330, 4.10000, 4.10000, 4.10000, 4.10000, 4.10000, 4.10000,&
                                       4.10000, 4.10000, 4.10000, 4.10000, 4.10000, 2.73330, 2.73330, 2.73330 ]

   real, save :: chord(nrchords)   = [ 3.54200, 3.85400, 4.16700, 4.55700, 4.65200, 4.45800, 4.24900, 4.00700, 3.74800,&
                                       3.50200, 3.25600, 3.01000, 2.76400, 2.51800, 2.31300, 2.08600, 1.41900]

!                                     cyl1      cyl2    DU40    DU35    DU35    DU30   DU25          DU21     NACA64
   integer, save :: nfoil(nrchords)= [  1,   1,    2,      3,      4,      4,      5,     6,     6,     7, 7, 8, 8, 8, 8, 8, 8 ]

! A twist is added along the length of the blade to optimize the amount of energy harvested. Typically, 10° to 20° of twist is
! included, with the twist at the tip being the highest. This produces a change in the apparent wind direction across the blade.
   real, save :: twist(nrchords)   = [ 0.0000, 0.0000, 0.0000,13.3080,11.4800,10.1620, 9.0110, 7.7950,&
                                       6.5440, 5.3610, 4.1880, 3.1250, 2.3190, 1.5260, 0.8630, 0.3700, 0.1060]

   integer, parameter :: nrc=8
   integer nrang(nrc)
   type foildata
      real deg
      real cl
      real cd
      real cm
   end type
   type(foildata) foil(150,nrc)

! The lift and drags below are not used as we read them from the tables
!   real, save :: lift(nrchords)    = [ 0.0000, 0.0000, 0.0000, 1.5380, 1.6090, 1.4750, 1.3900, 1.3360,&
!                                       1.2080, 1.1450, 0.9960, 0.7840, 0.6700, 0.6000, 0.5560, 0.5000, 0.4420]
!
!   real, save :: drag(nrchords)    = [ 0.5000, 0.5000, 0.3500, 0.1288, 0.0227, 0.0156, 0.0155, 0.0153,&
!                                       0.0117, 0.0103, 0.0071, 0.0053, 0.0053, 0.0052, 0.0052, 0.0052, 0.0052]

end module


!     1, 13.30800, 0.0000,  0.5000,
!     1, 13.30800, 0.0000,  0.5000,
!     2, 13.30800, 0.0000,  0.3500,
!     3, 13.30800, 1.5380,  0.1288,
!     4, 11.48000, 1.6090,  0.0227,
!     4, 10.16200, 1.4750,  0.0156,
!     5, 9.01100,  1.3900,  0.0155,
!     6, 7.79500,  1.3360,  0.0153,
!     6, 6.54400,  1.2080,  0.0117,
!     7, 5.36100,  1.1450,  0.0103,
!     7, 4.18800,  0.9960,  0.0071,
!     8, 3.12500,  0.7840,  0.0053,
!     8, 2.31900,  0.6700,  0.0053,
!     8, 1.52600,  0.6000,  0.0520,
!     8, 0.86300,  0.5560,  0.0520,
!     8, 0.37000,  0.5000,  0.0520,
!     8, 0.10600,  0.4420,  0.0520,
